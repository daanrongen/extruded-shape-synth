<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/109/three.min.js"></script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Advanced Creative Coding</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div id="container"></div>

    <script id="vertexShader" type="x-shader/x-vertex">
      precision highp float;
      varying vec3 myNormal;
      vec3 newPosition;
      uniform highp vec2 mouse;
      uniform highp float time;
      #define M_PI 3.14159265358979323846

      float rand(vec3 x) { return abs(sin(cos(dot(x, mouse.xyx)) * 100.)); }

      void main() {

        float angle = time;
        mat4 rotateX = mat4(1, 0, 0, 0, 0, cos(angle), sin(angle), 0, 0, -sin(angle),
                            cos(angle), 0, 0, 0, 0, 1);

        myNormal = normal;
        vec3 newPosition = position * (1.0 + (0.75 * (rand(position))));
        vec4 rotatedPos = rotateX * vec4(newPosition, 1.0);

        myNormal = normalize(rotatedPos.xyz * 1.2);

        gl_Position = projectionMatrix * modelViewMatrix * vec4(rotatedPos.xyz, 1.);
      }
    </script>

    <script id="fragmentShader" type="x-shader/x-fragment">
      precision highp float;
      uniform vec2 mouse;
      uniform float time;
      varying vec3 myNormal;

      void main() {
        vec3 light = vec3(0., 10., 5.);
        vec3 invert = vec3(1., 1., 1.);
        invert = myNormal * invert;

        light = normalize(light);
        float prod = max(0., dot(myNormal, light));

        gl_FragColor = vec4(prod, prod, prod, 1.0) + vec4(vec3(0.15), 1.);
      }
    </script>
  </body>

  <script type="text/javascript" src="script.js"></script>
</html>
